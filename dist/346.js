"use strict";(self.webpackChunkng2angle=self.webpackChunkng2angle||[]).push([[346],{6346:(F,p,c)=>{c.r(p),c.d(p,{CitiesModule:()=>H});var g=c(6895),d=c(6691),f=c(5229),m=c(1071),t=c(4650),u=c(2668);function x(n,s){1&n&&t._UZ(0,"div",22)}function q(n,s){if(1&n){const i=t.EpF();t.TgZ(0,"div",23)(1,"button",24),t._UZ(2,"em",25),t.qZA(),t.TgZ(3,"button",26),t.NdJ("click",function(){const a=t.CHM(i).value,r=t.oxw();return t.KtG(r.deleteCitiesData(a))}),t._UZ(4,"em",27),t.qZA()()}if(2&n){const i=s.value;t.xp6(1),t.MGl("routerLink","/cities/edit/",i,"")}}const Z=c(1373);let A=(()=>{class n{constructor(i){this.citiesService=i,this.Cities=[],this.arrayRowData="",this.rowsFilter=[],this.arrayTableData=[]}ngOnInit(){this.citiesService.getCitiesList().subscribe(i=>{this.Cities=[],this.Cities=i.map(e=>{let o=e.payload.doc.data();return{id:e.payload.doc.id,data:o}}),this.arrayTableData=[];for(let e=0;e<this.Cities.length;e++)this.arrayRowData=this.Cities[e].data,this.arrayRowData.sr_no=e+1,this.arrayRowData.id=this.Cities[e].id,this.arrayRowData.original_loc=this.Cities[e].data.original_loc&&this.Cities[e].data.original_loc.split(",")[0]||"--",this.arrayTableData.push(this.arrayRowData);this.rowsFilter=this.arrayTableData})}updateFilter(i){const e=i.target.value.toLowerCase(),o=this.arrayTableData.filter(function(a){if(""!=a.original_loc&&null!=a.original_loc)return-1!==a.original_loc.toLowerCase().indexOf(e)||!e});this.rowsFilter=o,this.table.offset=0}deleteCitiesData(i){this.sweetalertWarning(i)}sweetalertWarning(i){Z({title:"Are you sure?",text:"Want to delete data!",icon:"warning",buttons:{cancel:{text:"Cancel",value:null,visible:!0,className:"",closeModal:!0},confirm:{text:"Yes, delete it!",value:!0,visible:!0,className:"bg-danger",closeModal:!1}}}).then(e=>{e&&this.citiesService.deleteCities(i).then(()=>{Z("Deleted!","Data deletd!","success")})})}}return n.\u0275fac=function(i){return new(i||n)(t.Y36(u.e))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-city-list"]],viewQuery:function(i,e){if(1&i&&t.Gf(m.nE,7),2&i){let o;t.iGM(o=t.CRH())&&(e.table=o.first)}},decls:25,vars:10,consts:[[1,"content-heading"],[1,"d-flex","justify-content-between","w-100","align-items-center"],["type","button",1,"btn","btn-primary","d-flex","align-items-center",3,"routerLink"],["_ngcontent-lgi-c20","",1,"icon-plus","mr-1"],[1,"card","card-default"],["class","spinner-border loading","role","status",4,"ngIf"],[1,"card-body"],[1,"row","mb-3"],[1,"col-lg-3"],["type","text","placeholder","Type to filter the name column...",1,"form-control",3,"keyup"],[1,"bootstrap","no-detail-row",3,"scrollbarH","columnMode","footerHeight","rowHeight","limit","rows"],["table",""],["name","Sr. No.","prop","sr_no",3,"width"],["name","Actions","sortable","false","prop","id"],["ngx-datatable-cell-template",""],["name","Unique Id","prop","id",3,"width"],["name","Name","prop","original_loc"],["name","Name in English","prop","name_english"],["name","Name in Arabic","prop","name_arabic"],["name","Latitude","prop","latitude"],["name","Longitude","prop","longitude"],["name","Active","prop","is_enabled"],["role","status",1,"spinner-border","loading"],[1,"d-flex"],["type","button",1,"mr-1","btn","btn-success","comn-action-btn","mb-1",3,"routerLink"],["_ngcontent-lgi-c20","",1,"fas","fa-edit"],["type","button",1,"mr-1","btn","btn-danger","comn-action-btn","mb-1",3,"click"],["_ngcontent-lgi-c20","",1,"fas","fa-trash-alt"]],template:function(i,e){1&i&&(t.TgZ(0,"div",0)(1,"div",1)(2,"span"),t._uU(3,"Cities"),t.qZA(),t.TgZ(4,"button",2),t._UZ(5,"em",3),t._uU(6," Add New "),t.qZA()()(),t.TgZ(7,"div",4),t.YNc(8,x,1,0,"div",5),t.TgZ(9,"div",6)(10,"div",7)(11,"div",8)(12,"input",9),t.NdJ("keyup",function(a){return e.updateFilter(a)}),t.qZA()()(),t.TgZ(13,"ngx-datatable",10,11),t._UZ(15,"ngx-datatable-column",12),t.TgZ(16,"ngx-datatable-column",13),t.YNc(17,q,5,1,"ng-template",14),t.qZA(),t._UZ(18,"ngx-datatable-column",15)(19,"ngx-datatable-column",16)(20,"ngx-datatable-column",17)(21,"ngx-datatable-column",18)(22,"ngx-datatable-column",19)(23,"ngx-datatable-column",20)(24,"ngx-datatable-column",21),t.qZA()()()),2&i&&(t.xp6(4),t.Q6J("routerLink","/cities/add"),t.xp6(4),t.Q6J("ngIf",null==e.Cities||""==e.Cities),t.xp6(5),t.Q6J("scrollbarH",!0)("columnMode","force")("footerHeight",50)("rowHeight","auto")("limit",10)("rows",e.rowsFilter),t.xp6(2),t.Q6J("width",50),t.xp6(3),t.Q6J("width",180))},dependencies:[g.O5,d.rH,m.nE,m.UC,m.vq],encapsulation:2}),n})();var l=c(4719),h=c(5867),w=(c(2504),c(362)),M=c(8064),_=c(2734);const U=["citytext"];function S(n,s){1&n&&(t.TgZ(0,"div",22),t._uU(1," City is required"),t.qZA())}function L(n,s){1&n&&(t.TgZ(0,"div",22),t._uU(1," City is required"),t.qZA())}function J(n,s){1&n&&t._UZ(0,"span",23)}let v,C,y="";const I=["citytext"];function Q(n,s){1&n&&(t.TgZ(0,"div",22),t._uU(1," City is required"),t.qZA())}function k(n,s){1&n&&(t.TgZ(0,"div",22),t._uU(1," City is required"),t.qZA())}function Y(n,s){1&n&&t._UZ(0,"span",23)}let T,D,E;const R=[{path:"",component:A},{path:"list",component:A},{path:"add",component:(()=>{class n{constructor(i,e,o,a,r){this.validationService=e,this.citiesService=o,this.afs=a,this.router=r,this.saveLoading=!1,this.location={},this.autofillCity="",this.valForm=i.group({city:["",l.kI.required],city_english:["",l.kI.required],city_arabic:[""],isEnabled:[!0,l.kI.required]})}ngOnInit(){}ngAfterViewInit(){this.getPlaceAutocomplete()}getPlaceAutocomplete(){const i=new google.maps.places.Autocomplete(this.citytext.nativeElement,{componentRestrictions:{country:["SA"]}});google.maps.event.addListener(i,"place_changed",()=>{const e=i.getPlace();e.address_components.forEach(o=>{o.types.forEach(a=>{"locality"==a&&(y=o.long_name,this.autofillCity=y),"administrative_area_level_1"==a&&(v=o.long_name),"country"==a&&(C=o.long_name),console.log("type...."+y+" "+v+" "+C)})}),this.location={lat:e.geometry.location.lat(),lng:e.geometry.location.lng(),address:y+", "+v+", "+C,zoom:12}})}addCity(i,e){i.preventDefault();for(let o in this.valForm.controls)this.valForm.controls[o].markAsTouched();if(this.valForm.valid){console.log("city_english"+e.city_english);let o={original_loc:this.location.address,latitude:this.location.lat,longitude:this.location.lng,name_english:e.city_english,name_arabic:e.city_arabic,is_enabled:e.isEnabled,created_at:h.Z.firestore.FieldValue.serverTimestamp(),updated_at:h.Z.firestore.FieldValue.serverTimestamp()};this.afs.collection("cities",a=>a.where("original_loc","==",this.location.address).limit(1)).get().subscribe(a=>{a.size<=0?this.citiesService.addCities(o).then(()=>{this.saveLoading=!1,this.validationService.sweetalertSuccess(),this.router.navigate(["/cities"])}).catch(r=>{this.saveLoading=!1}):this.validationService.sweetalertError("City already entered!")})}else console.log("this.valForm",this.valForm)}}return n.\u0275fac=function(i){return new(i||n)(t.Y36(l.QS),t.Y36(w.R),t.Y36(u.e),t.Y36(M.ST),t.Y36(d.F0))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-city-add"]],viewQuery:function(i,e){if(1&i&&t.Gf(U,5),2&i){let o;t.iGM(o=t.CRH())&&(e.citytext=o.first)}},decls:36,vars:5,consts:[[1,"content-heading"],[1,"d-flex","justify-content-between","w-100","align-items-center"],["type","button",1,"btn","btn-primary","d-flex","align-items-center",3,"routerLink"],["_ngcontent-lgi-c20","",1,"icon-arrow-left","mr-1"],[1,"row"],[1,"col-md-12"],[1,"card","card-default"],[1,"card-body"],["role","form",1,"form-validate",3,"formGroup","ngSubmit","keydown.enter","keydown.shift.enter"],["dataPost","ngForm"],[1,"form-row"],[1,"col-12","col-md-4"],["required","","formControlName","city","city","city","type","text","placeholder","Enter atleast 3 words...",1,"form-control","with-focus"],["citytext",""],["class","text-danger",4,"ngIf"],[1,"col-12","col-md-3"],["required","","formControlName","city_english","type","text","placeholder","Enter City in English",1,"form-control","with-focus"],["formControlName","city_arabic","type","text","placeholder","Enter City in Arabic",1,"form-control","with-focus"],[1,"col-12","col-md-2"],["formControlName","isEnabled"],["type","submit",1,"btn","btn-sm","btn-info","mt-2"],["class","spinner-border spinner-border-sm ml-2",4,"ngIf"],[1,"text-danger"],[1,"spinner-border","spinner-border-sm","ml-2"]],template:function(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"div",0)(1,"div",1)(2,"span"),t._uU(3,"Add city"),t.qZA(),t.TgZ(4,"button",2),t._UZ(5,"em",3),t._uU(6," Back "),t.qZA()()(),t.TgZ(7,"div",4)(8,"div",5)(9,"div",6)(10,"div",7)(11,"form",8,9),t.NdJ("ngSubmit",function(r){t.CHM(o);const b=t.MAs(12);return t.KtG(e.addCity(r,b.value))})("keydown.enter",function(r){return r.preventDefault()})("keydown.shift.enter",function(r){return r.preventDefault()}),t.TgZ(13,"div",10)(14,"div",11)(15,"label"),t._uU(16,"City (Pick city from google locations.)"),t.qZA(),t._UZ(17,"input",12,13),t.YNc(19,S,2,0,"div",14),t.qZA(),t.TgZ(20,"div",15)(21,"label"),t._uU(22,"City In English"),t.qZA(),t._UZ(23,"input",16),t.YNc(24,L,2,0,"div",14),t.qZA(),t.TgZ(25,"div",15)(26,"label"),t._uU(27,"City In Arabic"),t.qZA(),t._UZ(28,"input",17),t.qZA(),t.TgZ(29,"div",18)(30,"label"),t._uU(31,"Active"),t.qZA(),t._UZ(32,"ui-switch",19),t.qZA()(),t.TgZ(33,"button",20),t._uU(34,"Save"),t.YNc(35,J,1,0,"span",21),t.qZA()()()()()()}2&i&&(t.xp6(4),t.Q6J("routerLink","/cities"),t.xp6(7),t.Q6J("formGroup",e.valForm),t.xp6(8),t.Q6J("ngIf",e.valForm.controls.city.hasError("required")&&(e.valForm.controls.city.dirty||e.valForm.controls.city.touched)),t.xp6(5),t.Q6J("ngIf",e.valForm.controls.city_english.hasError("required")&&(e.valForm.controls.city_english.dirty||e.valForm.controls.city_english.touched)),t.xp6(11),t.Q6J("ngIf",e.saveLoading))},dependencies:[g.O5,l._Y,l.Fj,l.JJ,l.JL,l.Q7,l.sg,l.u,d.rH,_.ob]}),n})()},{path:"edit/:id",component:(()=>{class n{constructor(i,e,o,a,r){this.validationService=e,this.citiesService=o,this.router=a,this.route=r,this.saveLoading=!1,this.location={},this.cityDetailData=[],this.valForm=i.group({city:["",l.kI.required],city_english:["",l.kI.required],city_arabic:[""],isEnabled:[!0,l.kI.required]})}ngOnInit(){this.id=this.route.snapshot.params.id,this.citiesService.getCitiesDetail(this.id).get().subscribe(i=>{i.exists&&(this.cityDetailData=i.data(),this.cityDetailData&&(this.location={lat:this.cityDetailData.latitude,lng:this.cityDetailData.longitude,address:this.cityDetailData.name}))})}ngAfterViewInit(){this.getPlaceAutocomplete()}getPlaceAutocomplete(){const i=new google.maps.places.Autocomplete(this.citytext.nativeElement,{componentRestrictions:{country:["SA"]}});google.maps.event.addListener(i,"place_changed",()=>{const e=i.getPlace();e.address_components.forEach(o=>{o.types.forEach(a=>{"locality"==a&&(T=o.long_name),"administrative_area_level_1"==a&&(D=o.long_name),"country"==a&&(E=o.long_name)})}),this.location={lat:e.geometry.location.lat(),lng:e.geometry.location.lng(),address:T+", "+D+", "+E,zoom:12}})}editCity(i,e){i.preventDefault();for(let o in this.valForm.controls)this.valForm.controls[o].markAsTouched();if(this.valForm.valid){let o={original_loc:this.location.address,latitude:this.location.lat,longitude:this.location.lng,name_english:e.city_english,name_arabic:e.city_arabic,is_enabled:e.isEnabled,updated_at:h.Z.firestore.FieldValue.serverTimestamp()};this.citiesService.updateCities(this.id,o).then(()=>{this.saveLoading=!1,this.validationService.sweetalertSuccess(),this.router.navigate(["/cities"])}).catch(a=>{this.saveLoading=!1})}else console.log("this.valForm",this.valForm)}}return n.\u0275fac=function(i){return new(i||n)(t.Y36(l.QS),t.Y36(w.R),t.Y36(u.e),t.Y36(d.F0),t.Y36(d.gz))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-city-edit"]],viewQuery:function(i,e){if(1&i&&t.Gf(I,5),2&i){let o;t.iGM(o=t.CRH())&&(e.citytext=o.first)}},decls:36,vars:9,consts:[[1,"content-heading"],[1,"d-flex","justify-content-between","w-100","align-items-center"],["type","button",1,"btn","btn-primary","d-flex","align-items-center",3,"routerLink"],["_ngcontent-lgi-c20","",1,"icon-arrow-left","mr-1"],[1,"row"],[1,"col-md-12"],[1,"card","card-default"],[1,"card-body"],["role","form",1,"form-validate",3,"formGroup","ngSubmit","keydown.enter","keydown.shift.enter"],["dataPost","ngForm"],[1,"form-row"],[1,"col-12","col-md-4"],["required","","formControlName","city","city","city","type","text","placeholder","Enter city",1,"form-control","with-focus",3,"ngModel","ngModelChange"],["citytext",""],["class","text-danger",4,"ngIf"],[1,"col-12","col-md-3"],["required","","formControlName","city_english","type","text","placeholder","Enter City in English",1,"form-control","with-focus",3,"ngModel","ngModelChange"],["formControlName","city_arabic","type","text","placeholder","Enter City in Arabic",1,"form-control","with-focus",3,"ngModel","ngModelChange"],[1,"col-12","col-md-2"],["formControlName","isEnabled",3,"ngModel","ngModelChange"],["type","submit",1,"btn","btn-sm","btn-info","mt-2"],["class","spinner-border spinner-border-sm ml-2",4,"ngIf"],[1,"text-danger"],[1,"spinner-border","spinner-border-sm","ml-2"]],template:function(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"div",0)(1,"div",1)(2,"span"),t._uU(3,"Edit city"),t.qZA(),t.TgZ(4,"button",2),t._UZ(5,"em",3),t._uU(6," Back "),t.qZA()()(),t.TgZ(7,"div",4)(8,"div",5)(9,"div",6)(10,"div",7)(11,"form",8,9),t.NdJ("ngSubmit",function(r){t.CHM(o);const b=t.MAs(12);return t.KtG(e.editCity(r,b.value))})("keydown.enter",function(r){return r.preventDefault()})("keydown.shift.enter",function(r){return r.preventDefault()}),t.TgZ(13,"div",10)(14,"div",11)(15,"label"),t._uU(16,"City"),t.qZA(),t.TgZ(17,"input",12,13),t.NdJ("ngModelChange",function(r){return e.cityDetailData.original_loc=r}),t.qZA(),t.YNc(19,Q,2,0,"div",14),t.qZA(),t.TgZ(20,"div",15)(21,"label"),t._uU(22,"City In English"),t.qZA(),t.TgZ(23,"input",16),t.NdJ("ngModelChange",function(r){return e.cityDetailData.name_english=r}),t.qZA(),t.YNc(24,k,2,0,"div",14),t.qZA(),t.TgZ(25,"div",15)(26,"label"),t._uU(27,"City In Arabic"),t.qZA(),t.TgZ(28,"input",17),t.NdJ("ngModelChange",function(r){return e.cityDetailData.name_arabic=r}),t.qZA()(),t.TgZ(29,"div",18)(30,"label"),t._uU(31,"Active"),t.qZA(),t.TgZ(32,"ui-switch",19),t.NdJ("ngModelChange",function(r){return e.cityDetailData.is_enabled=r}),t.qZA()()(),t.TgZ(33,"button",20),t._uU(34,"Save"),t.YNc(35,Y,1,0,"span",21),t.qZA()()()()()()}2&i&&(t.xp6(4),t.Q6J("routerLink","/cities"),t.xp6(7),t.Q6J("formGroup",e.valForm),t.xp6(6),t.Q6J("ngModel",e.cityDetailData.original_loc),t.xp6(2),t.Q6J("ngIf",e.valForm.controls.city.hasError("required")&&(e.valForm.controls.city.dirty||e.valForm.controls.city.touched)),t.xp6(4),t.Q6J("ngModel",e.cityDetailData.name_english),t.xp6(1),t.Q6J("ngIf",e.valForm.controls.city_english.hasError("required")&&(e.valForm.controls.city_english.dirty||e.valForm.controls.city_english.touched)),t.xp6(4),t.Q6J("ngModel",e.cityDetailData.name_arabic),t.xp6(4),t.Q6J("ngModel",e.cityDetailData.is_enabled),t.xp6(3),t.Q6J("ngIf",e.saveLoading))},dependencies:[g.O5,l._Y,l.Fj,l.JJ,l.JL,l.Q7,l.sg,l.u,d.rH,_.ob]}),n})()}];let H=(()=>{class n{}return n.\u0275fac=function(i){return new(i||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[g.ez,f.m,_.Su,m.xD,d.Bz.forChild(R),d.Bz]}),n})()},362:(F,p,c)=>{c.d(p,{R:()=>f});var g=c(4650);const d=c(1373);let f=(()=>{class m{constructor(){}sweetalertError(u){d(u,"","error")}sweetalertSuccess(){d("Data saved successfully!","","success")}sweetalertUpdateSuccess(){d("Data updated successfully!","","success")}sweetalertFileUploadSuccess(){d("file uploaded successfully!","","success")}}return m.\u0275fac=function(u){return new(u||m)},m.\u0275prov=g.Yz7({token:m,factory:m.\u0275fac,providedIn:"root"}),m})()}}]);